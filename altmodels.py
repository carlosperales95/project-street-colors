images =  Input(shape=(576, 384, 3))
output_1a = Conv2D(64, (3, 3),  padding='same')(images)
output_1b = GroupNormalization()(output_1a)
output_1 = Activation('relu')(output_1b)
output_2a = Conv2D(64, (3, 3),  padding='same')(output_1)
output_2b = GroupNormalization()(output_2a)
output_2 = Activation('relu')(output_2b)
output_3, argmax1 = MaxPoolingWithArgmax2D((2, 2))(output_2)
output_4a = Conv2D(128, (3, 3),  padding='same')(output_3)
output_4b = GroupNormalization()(output_4a)
output_4 = Activation('relu')(output_4b)
output_5a = Conv2D(128, (3, 3),  padding='same')(output_4)
output_5b = GroupNormalization()(output_5a)
output_5 = Activation('relu')(output_5b)
output_6, argmax2 = MaxPoolingWithArgmax2D((2, 2))(output_5)
output_7a = Conv2D(256, (3, 3),  padding='same')(output_6)
output_7b = GroupNormalization()(output_7a)
output_7 = Activation('relu')(output_7b)
output_8a = Conv2D(256, (3, 3),  padding='same')(output_7)
output_8b = GroupNormalization()(output_8a)
output_8 = Activation('relu')(output_8b)
output_9a = Conv2D(256, (3, 3),  padding='same')(output_8)
output_9b = GroupNormalization()(output_9a)
output_9 = Activation('relu')(output_9b)
output_10, argmax3 = MaxPoolingWithArgmax2D((2, 2))(output_9)
output_11a = Conv2D(512, (3, 3),  padding='same')(output_10)
output_11b = GroupNormalization()(output_11a)
output_11 = Activation('relu')(output_11b)
output_12a = Conv2D(512, (3, 3),  padding='same')(output_11)
output_12b = GroupNormalization()(output_12a)
output_12 = Activation('relu')(output_12b)
output_13a = Conv2D(512, (3, 3),  padding='same')(output_12)
output_13b = GroupNormalization()(output_13a)
output_13 = Activation('relu')(output_13b)
output_14, argmax4 = MaxPoolingWithArgmax2D((2, 2))(output_13)
output_15a = Conv2D(512, (3, 3),  padding='same')(output_14)
output_15b = GroupNormalization()(output_15a)
output_15 = Activation('relu')(output_15b)
output_16a = Conv2D(512, (3, 3),  padding='same')(output_15)
output_16b = GroupNormalization()(output_16a)
output_16 = Activation('relu')(output_16b)
output_17a = Conv2D(512, (3, 3),  padding='same')(output_16)
output_17b = GroupNormalization()(output_17a)
output_17 = Activation('relu')(output_17b)
output_18, argmax5 = MaxPoolingWithArgmax2D((2, 2))(output_17)

output_19 = MaxUnpooling2D((2,2))([output_18, argmax5])
output_20a = Conv2D(512, (3, 3),  padding='same')(output_19)
output_20b = GroupNormalization()(output_20a)
output_20 = Activation('relu')(output_20b)
output_21a = Conv2D(512, (3, 3),  padding='same')(output_20)
output_21b = GroupNormalization()(output_21a)
output_21 = Activation('relu')(output_21b)
output_22a = Conv2D(512, (3, 3),  padding='same')(output_21)
output_22b = GroupNormalization()(output_22a)
output_22 = Activation('relu')(output_22b)
output_23 = MaxUnpooling2D((2,2))([output_22, argmax4])
output_24a = Conv2D(512, (3, 3),  padding='same')(output_23)
output_24b = GroupNormalization()(output_24a)
output_24 = Activation('relu')(output_24b)
output_25a = Conv2D(512, (3, 3),  padding='same')(output_24)
output_25b = GroupNormalization()(output_25a)
output_25 = Activation('relu')(output_25b)
output_26a = Conv2D(256, (3, 3),  padding='same')(output_25)
output_26b = GroupNormalization()(output_26a)
output_26 = Activation('relu')(output_26b)
output_27 = MaxUnpooling2D((2,2))([output_26, argmax3])
output_28a = Conv2D(256, (3, 3),  padding='same')(output_27)
output_28b = GroupNormalization()(output_28a)
output_28 = Activation('relu')(output_28b)
output_29a = Conv2D(256, (3, 3),  padding='same')(output_28)
output_29b = GroupNormalization()(output_29a)
output_29 = Activation('relu')(output_29b)
output_30a = Conv2D(128, (3, 3),  padding='same')(output_29)
output_30b = GroupNormalization()(output_30a)
output_30 = Activation('relu')(output_30b)
output_31 = MaxUnpooling2D((2,2))([output_30, argmax2])
output_32a = Conv2D(128, (3, 3),  padding='same')(output_31)
output_32b = GroupNormalization()(output_32a)
output_32 = Activation('relu')(output_32b)
output_33a = Conv2D(64, (3, 3),  padding='same')(output_32)
output_33b = GroupNormalization()(output_33a)
output_33 = Activation('relu')(output_33b)
output_34 = MaxUnpooling2D((2,2))([output_33, argmax1])
output_35a = Conv2D(64, (3, 3),  padding='same')(output_34)
output_35b = GroupNormalization()(output_35a)
output_35 = Activation('relu')(output_35b)
output_36a = Conv2D(66, (3, 3),  padding='same')(output_35)
output_36b = GroupNormalization(groups=33)(output_36a)
predictions = Activation('softmax')(output_36b)

##################################

images =  Input(shape=(img_width, img_height, 3))
output_1a = Conv2D(64, (3, 3),  padding='same')(images)
output_1b = GroupNormalization()(output_1a)
output_1 = Activation('relu')(output_1a)
output_2a = Conv2D(64, (3, 3),  padding='same')(output_1)
output_2b = GroupNormalization()(output_2a)
output_2 = Activation('relu')(output_2a)
output_3, argmax1 = MaxPoolingWithArgmax2D((2, 2))(output_2)
output_4a = Conv2D(128, (3, 3),  padding='same')(output_3)
output_4b = GroupNormalization()(output_4a)
output_4 = Activation('relu')(output_4a)
output_5a = Conv2D(128, (3, 3),  padding='same')(output_4)
output_5b = GroupNormalization()(output_5a)
output_5 = Activation('relu')(output_5a)
output_6, argmax2 = MaxPoolingWithArgmax2D((2, 2))(output_5)
output_7a = Conv2D(256, (3, 3),  padding='same')(output_6)
output_7b = GroupNormalization()(output_7a)
output_7 = Activation('relu')(output_7a)
output_8a = Conv2D(256, (3, 3),  padding='same')(output_7)
output_8b = GroupNormalization()(output_8a)
output_8 = Activation('relu')(output_8a)
output_9a = Conv2D(256, (3, 3),  padding='same')(output_8)
output_9b = GroupNormalization()(output_9a)
output_9 = Activation('relu')(output_9a)
output_10, argmax3 = MaxPoolingWithArgmax2D((2, 2))(output_9)
output_11a = Conv2D(512, (3, 3),  padding='same')(output_10)
output_11b = GroupNormalization()(output_11a)
output_11 = Activation('relu')(output_11a)
output_12a = Conv2D(512, (3, 3),  padding='same')(output_11)
output_12b = GroupNormalization()(output_12a)
output_12 = Activation('relu')(output_12a)
output_13a = Conv2D(512, (3, 3),  padding='same')(output_12)
output_13b = GroupNormalization()(output_13a)
output_13 = Activation('relu')(output_13a)
output_14, argmax4 = MaxPoolingWithArgmax2D((2, 2))(output_13)
output_15a = Conv2D(512, (3, 3),  padding='same')(output_14)
output_15b = GroupNormalization()(output_15a)
output_15 = Activation('relu')(output_15a)
output_16a = Conv2D(512, (3, 3),  padding='same')(output_15)
output_16b = GroupNormalization()(output_16a)
output_16 = Activation('relu')(output_16a)
output_17a = Conv2D(512, (3, 3),  padding='same')(output_16)
output_17b = GroupNormalization()(output_17a)
output_17 = Activation('relu')(output_17a)
output_18, argmax5 = MaxPoolingWithArgmax2D((2, 2))(output_17)

output_19 = MaxUnpooling2D((2,2))([output_18, argmax5])
output_20a = Conv2D(512, (3, 3),  padding='same')(output_19)
output_20b = GroupNormalization()(output_20a)
output_20 = Activation('relu')(output_20a)
output_21a = Conv2D(512, (3, 3),  padding='same')(output_20)
output_21b = GroupNormalization()(output_21a)
output_21 = Activation('relu')(output_21a)
output_22a = Conv2D(512, (3, 3),  padding='same')(output_21)
output_22b = GroupNormalization()(output_22a)
output_22 = Activation('relu')(output_22a)
output_23 = MaxUnpooling2D((2,2))([output_22, argmax4])
output_24a = Conv2D(512, (3, 3),  padding='same')(output_23)
output_24b = GroupNormalization()(output_24a)
output_24 = Activation('relu')(output_24a)
output_25a = Conv2D(512, (3, 3),  padding='same')(output_24)
output_25b = GroupNormalization()(output_25a)
output_25 = Activation('relu')(output_25a)
output_26a = Conv2D(256, (3, 3),  padding='same')(output_25)
output_26b = GroupNormalization()(output_26a)
output_26 = Activation('relu')(output_26a)
output_27 = MaxUnpooling2D((2,2))([output_26, argmax3])
output_28a = Conv2D(256, (3, 3),  padding='same')(output_27)
output_28b = GroupNormalization()(output_28a)
output_28 = Activation('relu')(output_28a)
output_29a = Conv2D(256, (3, 3),  padding='same')(output_28)
output_29b = GroupNormalization()(output_29a)
output_29 = Activation('relu')(output_29a)
output_30a = Conv2D(128, (3, 3),  padding='same')(output_29)
output_30b = GroupNormalization()(output_30a)
output_30 = Activation('relu')(output_30a)
output_31 = MaxUnpooling2D((2,2))([output_30, argmax2])
output_32a = Conv2D(128, (3, 3),  padding='same')(output_31)
output_32b = GroupNormalization()(output_32a)
output_32 = Activation('relu')(output_32a)
output_33a = Conv2D(64, (3, 3),  padding='same')(output_32)
output_33b = GroupNormalization()(output_33a)
output_33 = Activation('relu')(output_33a)
output_34 = MaxUnpooling2D((2,2))([output_33, argmax1])
output_35a = Conv2D(64, (3, 3),  padding='same')(output_34)
output_35b = GroupNormalization()(output_35a)
output_35 = Activation('relu')(output_35a)
output_36a = Conv2D(66, (3, 3),  padding='same')(output_35)
output_36b = GroupNormalization(groups=33)(output_36a)
predictions = Activation('softmax')(output_36a)

##########################################################

images =  Input(shape=(img_width, img_height, 3))
output_1a = Conv2D(64, (3, 3),  padding='same')(images)
output_1b = InstanceNormalization()(output_1a)
output_1 = Activation('relu')(output_1b)
output_2a = Conv2D(64, (3, 3),  padding='same')(output_1)
output_2b = InstanceNormalization()(output_2a)
output_2 = Activation('relu')(output_2b)
output_3, argmax1 = MaxPoolingWithArgmax2D((2, 2))(output_2)
output_4a = Conv2D(128, (3, 3),  padding='same')(output_3)
output_4b = InstanceNormalization()(output_4a)
output_4 = Activation('relu')(output_4b)
output_5a = Conv2D(128, (3, 3),  padding='same')(output_4)
output_5b = InstanceNormalization()(output_5a)
output_5 = Activation('relu')(output_5b)
output_6, argmax2 = MaxPoolingWithArgmax2D((2, 2))(output_5)
output_7a = Conv2D(256, (3, 3),  padding='same')(output_6)
output_7b = InstanceNormalization()(output_7a)
output_7 = Activation('relu')(output_7b)
output_8a = Conv2D(256, (3, 3),  padding='same')(output_7)
output_8b = InstanceNormalization()(output_8a)
output_8 = Activation('relu')(output_8b)
output_9a = Conv2D(256, (3, 3),  padding='same')(output_8)
output_9b = InstanceNormalization()(output_9a)
output_9 = Activation('relu')(output_9b)
output_10, argmax3 = MaxPoolingWithArgmax2D((2, 2))(output_9)
output_11a = Conv2D(512, (3, 3),  padding='same')(output_10)
output_11b = InstanceNormalization()(output_11a)
output_11 = Activation('relu')(output_11b)
output_12a = Conv2D(512, (3, 3),  padding='same')(output_11)
output_12b = InstanceNormalization()(output_12a)
output_12 = Activation('relu')(output_12b)
output_13a = Conv2D(512, (3, 3),  padding='same')(output_12)
output_13b = InstanceNormalization()(output_13a)
output_13 = Activation('relu')(output_13b)
output_14, argmax4 = MaxPoolingWithArgmax2D((2, 2))(output_13)
output_15a = Conv2D(512, (3, 3),  padding='same')(output_14)
output_15b = InstanceNormalization()(output_15a)
output_15 = Activation('relu')(output_15b)
output_16a = Conv2D(512, (3, 3),  padding='same')(output_15)
output_16b = InstanceNormalization()(output_16a)
output_16 = Activation('relu')(output_16b)
output_17a = Conv2D(512, (3, 3),  padding='same')(output_16)
output_17b = InstanceNormalization()(output_17a)
output_17 = Activation('relu')(output_17b)
output_18, argmax5 = MaxPoolingWithArgmax2D((2, 2))(output_17)

output_19 = MaxUnpooling2D((2,2))([output_18, argmax5])
output_20a = Conv2D(512, (3, 3),  padding='same')(output_19)
output_20b = InstanceNormalization()(output_20a)
output_20 = Activation('relu')(output_20b)
output_21a = Conv2D(512, (3, 3),  padding='same')(output_20)
output_21b = InstanceNormalization()(output_21a)
output_21 = Activation('relu')(output_21b)
output_22a = Conv2D(512, (3, 3),  padding='same')(output_21)
output_22b = InstanceNormalization()(output_22a)
output_22 = Activation('relu')(output_22b)
output_23 = MaxUnpooling2D((2,2))([output_22, argmax4])
output_24a = Conv2D(512, (3, 3),  padding='same')(output_23)
output_24b = InstanceNormalization()(output_24a)
output_24 = Activation('relu')(output_24b)
output_25a = Conv2D(512, (3, 3),  padding='same')(output_24)
output_25b = InstanceNormalization()(output_25a)
output_25 = Activation('relu')(output_25b)
output_26a = Conv2D(256, (3, 3),  padding='same')(output_25)
output_26b = InstanceNormalization()(output_26a)
output_26 = Activation('relu')(output_26b)
output_27 = MaxUnpooling2D((2,2))([output_26, argmax3])
output_28a = Conv2D(256, (3, 3),  padding='same')(output_27)
output_28b = InstanceNormalization()(output_28a)
output_28 = Activation('relu')(output_28b)
output_29a = Conv2D(256, (3, 3),  padding='same')(output_28)
output_29b = InstanceNormalization()(output_29a)
output_29 = Activation('relu')(output_29b)
output_30a = Conv2D(128, (3, 3),  padding='same')(output_29)
output_30b = InstanceNormalization()(output_30a)
output_30 = Activation('relu')(output_30b)
output_31 = MaxUnpooling2D((2,2))([output_30, argmax2])
output_32a = Conv2D(128, (3, 3),  padding='same')(output_31)
output_32b = InstanceNormalization()(output_32a)
output_32 = Activation('relu')(output_32b)
output_33a = Conv2D(64, (3, 3),  padding='same')(output_32)
output_33b = InstanceNormalization()(output_33a)
output_33 = Activation('relu')(output_33b)
output_34 = MaxUnpooling2D((2,2))([output_33, argmax1])
output_35a = Conv2D(64, (3, 3),  padding='same')(output_34)
output_35b = InstanceNormalization()(output_35a)
output_35 = Activation('relu')(output_35b)
output_36a = Conv2D(66, (1, 1),  padding='same')(output_35)
output_36b = InstanceNormalization()(output_36a)
predictions = Activation('softmax')(output_36a)

########################################################
images =  Input(shape=(img_width, img_height, 3))
output_1a = Conv2D(64, (3, 3),  padding='same')(images)
output_1b = BatchNormalization()(output_1a)
output_1 = Activation('relu')(output_1a)
output_2a = Conv2D(64, (3, 3),  padding='same')(output_1)
output_2b = BatchNormalization()(output_2a)
output_2 = Activation('relu')(output_2a)
output_3, argmax1 = MaxPoolingWithArgmax2D(output_2,ksize=(1, 2,2,1),strides=[1,1,1,1],padding='SAME')
output_4a = Conv2D(128, (3, 3),  padding='same')(output_3)
output_4b = BatchNormalization()(output_4a)
output_4 = Activation('relu')(output_4a)
output_5a = Conv2D(128, (3, 3),  padding='same')(output_4)
output_5b = BatchNormalization()(output_5a)
output_5 = Activation('relu')(output_5a)
output_6, argmax2 = MaxPoolingWithArgmax2D(output_5,ksize=(1, 2,2,1),strides=[1,1,1,1],padding='SAME')
output_7a = Conv2D(256, (3, 3),  padding='same')(output_6)
output_7b = BatchNormalization()(output_7a)
output_7 = Activation('relu')(output_7a)
output_8a = Conv2D(256, (3, 3),  padding='same')(output_7)
output_8b = BatchNormalization()(output_8a)
output_8 = Activation('relu')(output_8a)
output_9a = Conv2D(256, (3, 3),  padding='same')(output_8)
output_9b = BatchNormalization()(output_9a)
output_9 = Activation('relu')(output_9a)
output_10, argmax3 = MaxPoolingWithArgmax2D(output_9,ksize=(1, 2,2,1),strides=[1,1,1,1],padding='SAME')
output_11a = Conv2D(512, (3, 3),  padding='same')(output_10)
output_11b = BatchNormalization()(output_11a)
output_11 = Activation('relu')(output_11a)
output_12a = Conv2D(512, (3, 3),  padding='same')(output_11)
output_12b = BatchNormalization()(output_12a)
output_12 = Activation('relu')(output_12a)
output_13a = Conv2D(512, (3, 3),  padding='same')(output_12)
output_13b = BatchNormalization()(output_13a)
output_13 = Activation('relu')(output_13a)
output_14, argmax4 = MaxPoolingWithArgmax2D(output_13,ksize=(1, 2,2,1),strides=[1,1,1,1],padding='SAME')
output_15a = Conv2D(512, (3, 3),  padding='same')(output_14)
output_15b = BatchNormalization()(output_15a)
output_15 = Activation('relu')(output_15a)
output_16a = Conv2D(512, (3, 3),  padding='same')(output_15)
output_16b = BatchNormalization()(output_16a)
output_16 = Activation('relu')(output_16a)
output_17a = Conv2D(512, (3, 3),  padding='same')(output_16)
output_17b = BatchNormalization()(output_17a)
output_17 = Activation('relu')(output_17a)
output_18, argmax5 = MaxPoolingWithArgmax2D(output_17,ksize=(1, 2,2,1),strides=[1,1,1,1],padding='SAME')

output_19 = MaxUnpooling2D(output_18, argmax5)
output_20a = Conv2D(512, (3, 3),  padding='same')(output_19)
output_20b = BatchNormalization()(output_20a)
output_20 = Activation('relu')(output_20a)
output_21a = Conv2D(512, (3, 3),  padding='same')(output_20)
output_21b = BatchNormalization()(output_21a)
output_21 = Activation('relu')(output_21a)
output_22a = Conv2D(512, (3, 3),  padding='same')(output_21)
output_22b = BatchNormalization()(output_22a)
output_22 = Activation('relu')(output_22a)
output_23 = MaxUnpooling2D(output_22, argmax4, scope='kek')
output_24a = Conv2D(512, (3, 3),  padding='same')(output_23)
output_24b = BatchNormalization()(output_24a)
output_24 = Activation('relu')(output_24a)
output_25a = Conv2D(512, (3, 3),  padding='same')(output_24)
output_25b = BatchNormalization()(output_25a)
output_25 = Activation('relu')(output_25a)
output_26a = Conv2D(256, (3, 3),  padding='same')(output_25)
output_26b = BatchNormalization()(output_26a)
output_26 = Activation('relu')(output_26a)
output_27 = MaxUnpooling2D(output_26, argmax3,scope='lel')
output_28a = Conv2D(256, (3, 3),  padding='same')(output_27)
output_28b = BatchNormalization()(output_28a)
output_28 = Activation('relu')(output_28a)
output_29a = Conv2D(256, (3, 3),  padding='same')(output_28)
output_29b = BatchNormalization()(output_29a)
output_29 = Activation('relu')(output_29a)
output_30a = Conv2D(128, (3, 3),  padding='same')(output_29)
output_30b = BatchNormalization()(output_30a)
output_30 = Activation('relu')(output_30a)
output_31 = MaxUnpooling2D(output_30, argmax2,scope='wtf')
output_32a = Conv2D(128, (3, 3),  padding='same')(output_31)
output_32b = BatchNormalization()(output_32a)
output_32 = Activation('relu')(output_32a)
output_33a = Conv2D(64, (3, 3),  padding='same')(output_32)
output_33b = BatchNormalization()(output_33a)
output_33 = Activation('relu')(output_33a)
output_34 = MaxUnpooling2D(output_33, argmax1,scope='srsly')
output_35a = Conv2D(64, (3, 3),  padding='same')(output_34)
output_35b = BatchNormalization()(output_35a)
output_35 = Activation('relu')(output_35a)
output_36a = Conv2D(66, (3, 3),  padding='same')(output_35)
output_36b = BatchNormalization()(output_36a)
predictions = Activation('softmax')(output_36a)

################################################

images =  Input(shape=(img_width, img_height, 3))
output_1a = Conv2D(64, (3, 3),  padding='same')(images)
output_1 = Activation('relu')(output_1a)
output_2a = Conv2D(64, (3, 3),  padding='same')(output_1)
output_2 = Activation('relu')(output_2a)
output_3, argmax1 = MaxPoolingWithArgmax2D(output_2,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')
output_4a = Conv2D(128, (3, 3),  padding='same')(output_3)
output_4 = Activation('relu')(output_4a)
output_5a = Conv2D(128, (3, 3),  padding='same')(output_4)
output_5 = Activation('relu')(output_5a)
output_6, argmax2 = MaxPoolingWithArgmax2D(output_5,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')
output_7a = Conv2D(256, (3, 3),  padding='same')(output_6)
output_7 = Activation('relu')(output_7a)
output_8a = Conv2D(256, (3, 3),  padding='same')(output_7)
output_8 = Activation('relu')(output_8a)
output_9a = Conv2D(256, (3, 3),  padding='same')(output_8)
output_9 = Activation('relu')(output_9a)
output_10, argmax3 = MaxPoolingWithArgmax2D(output_9,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')
output_11a = Conv2D(512, (3, 3),  padding='same')(output_10)
output_11 = Activation('relu')(output_11a)
output_12a = Conv2D(512, (3, 3),  padding='same')(output_11)
output_12 = Activation('relu')(output_12a)
output_13a = Conv2D(512, (3, 3),  padding='same')(output_12)
output_13 = Activation('relu')(output_13a)
output_14, argmax4 = MaxPoolingWithArgmax2D(output_13,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')
output_15a = Conv2D(512, (3, 3),  padding='same')(output_14)
output_15 = Activation('relu')(output_15a)
output_16a = Conv2D(512, (3, 3),  padding='same')(output_15)
output_16 = Activation('relu')(output_16a)
output_17a = Conv2D(512, (3, 3),  padding='same')(output_16)
output_17 = Activation('relu')(output_17a)
output_18, argmax5 = MaxPoolingWithArgmax2D(output_17,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')

output_19 = MaxUnpooling2D(output_18, argmax5)
output_20a = Conv2D(512, (3, 3),  padding='same')(output_19)
output_20 = Activation('relu')(output_20a)
output_21a = Conv2D(512, (3, 3),  padding='same')(output_20)
output_21 = Activation('relu')(output_21a)
output_22a = Conv2D(512, (3, 3),  padding='same')(output_21)
output_22 = Activation('relu')(output_22a)
output_23 = MaxUnpooling2D(output_22, argmax4)
output_24a = Conv2D(512, (3, 3),  padding='same')(output_23)
output_24 = Activation('relu')(output_24a)
output_25a = Conv2D(512, (3, 3),  padding='same')(output_24)
output_25 = Activation('relu')(output_25a)
output_26a = Conv2D(256, (3, 3),  padding='same')(output_25)
output_26 = Activation('relu')(output_26a)
output_27 = MaxUnpooling2D(output_26, argmax3)
output_28a = Conv2D(256, (3, 3),  padding='same')(output_27)
output_28 = Activation('relu')(output_28a)
output_29a = Conv2D(256, (3, 3),  padding='same')(output_28)
output_29 = Activation('relu')(output_29a)
output_30a = Conv2D(128, (3, 3),  padding='same')(output_29)
output_30 = Activation('relu')(output_30a)
output_31 = MaxUnpooling2D(output_30, argmax2)
output_32a = Conv2D(128, (3, 3),  padding='same')(output_31)
output_32 = Activation('relu')(output_32a)
output_33a = Conv2D(64, (3, 3),  padding='same')(output_32)
output_33 = Activation('relu')(output_33a)
output_34 = MaxUnpooling2D(output_33, argmax1)
output_35a = Conv2D(64, (3, 3),  padding='same')(output_34)
output_35 = Activation('relu')(output_35a)
output_36a = Conv2D(66, (3, 3),  padding='same')(output_35)
predictions = Activation('softmax')(output_36a)

############################### Segnet wo 2 poolings
images =  Input(shape=(img_width, img_height, 3))
output_1a = Conv2D(64, (3, 3),  padding='same')(images)
output_1 = Activation('relu')(output_1a)
output_2a = Conv2D(64, (3, 3),  padding='same')(output_1)
output_2 = Activation('relu')(output_2a)
output_3, argmax1 = MaxPoolingWithArgmax2D(output_2,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')
output_4a = Conv2D(128, (3, 3),  padding='same')(output_3)
output_4 = Activation('relu')(output_4a)
output_5a = Conv2D(128, (3, 3),  padding='same')(output_4)
output_5 = Activation('relu')(output_5a)
output_6, argmax2 = MaxPoolingWithArgmax2D(output_5,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')
output_7a = Conv2D(256, (3, 3),  padding='same')(output_6)
output_7 = Activation('relu')(output_7a)
output_8a = Conv2D(256, (3, 3),  padding='same')(output_7)
output_8 = Activation('relu')(output_8a)
output_9a = Conv2D(256, (3, 3),  padding='same')(output_8)
output_9 = Activation('relu')(output_9a)
output_10, argmax3 = MaxPoolingWithArgmax2D(output_9,ksize=(1, 2,2,1),strides=[1,2,2,1],padding='SAME')

output_27 = MaxUnpooling2D(output_10, argmax3)
output_28a = Conv2D(256, (3, 3),  padding='same')(output_27)
output_28 = Activation('relu')(output_28a)
output_29a = Conv2D(256, (3, 3),  padding='same')(output_28)
output_29 = Activation('relu')(output_29a)
output_30a = Conv2D(128, (3, 3),  padding='same')(output_29)
output_30 = Activation('relu')(output_30a)
output_31 = MaxUnpooling2D(output_30, argmax2)
output_32a = Conv2D(128, (3, 3),  padding='same')(output_31)
output_32 = Activation('relu')(output_32a)
output_33a = Conv2D(64, (3, 3),  padding='same')(output_32)
output_33 = Activation('relu')(output_33a)
output_34 = MaxUnpooling2D(output_33, argmax1)
output_35a = Conv2D(64, (3, 3),  padding='same')(output_34)
output_35 = Activation('relu')(output_35a)
output_36a = Conv2D(66, (3, 3),  padding='same')(output_35)
predictions = Activation('softmax')(output_36a)

####################################